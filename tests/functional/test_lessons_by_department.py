from case_study.lessons_by_department import get_nb_lessons_by_department


def test_get_nb_lessons_by_department():
    # When
    results = get_nb_lessons_by_department(partnership_types=["EI"],
                                           start_date="2020-07-01",
                                           end_date="2020-07-03")
    # Then
    expected = {'01': 20,
                '02': 4,
                '06': 4,
                '08': 4,
                '10': 5,
                '13': 14,
                '14': 15,
                '17': 12,
                '21': 7,
                '26': 7,
                '27': 4,
                '29': 2,
                '30': 16,
                '33': 22,
                '34': 16,
                '35': 3,
                '37': 12,
                '38': 25,
                '41': 17,
                '42': 6,
                '44': 20,
                '45': 5,
                '51': 4,
                '54': 4,
                '57': 4,
                '59': 12,
                '62': 12,
                '67': 5,
                '68': 4,
                '69': 18,
                '72': 5,
                '73': 10,
                '74': 3,
                '75': 47,
                '76': 4,
                '77': 64,
                '78': 11,
                '79': 8,
                '82': 8,
                '84': 3,
                '89': 12,
                '91': 27,
                '92': 34,
                '93': 61,
                '94': 51,
                '95': 18}
    assert expected == results
